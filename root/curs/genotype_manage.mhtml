<%args>
$curs_root_uri
$pub
$read_only_curs => 0
</%args>

<div ng-controller="GenotypeManageCtrl"
     id="curs-genotype-manage" class="genotype-list">
  <div ng-hide="data.genotypeSearching">
  <div class="row">
% if (!$read_only_curs) {
    <div class="curs-top-help">
Search, view, and edit pathogen genotypes for phenotype annotation in this session
    </div>
    <div class="col-sm-5 col-md-5">
    <div class="curs-box">
      <div class="curs-box-title">
Actions
      </div>
      <div class="curs-box-body">
        <div class="feature-list-action">
          <a ng-click="startSearch()" href="#">Find an existing pathogen genotype ...</a>
        </div>
        <div class="feature-list-action">
          <a href="<% $start_path . '/feature/genotype/add' %>">Add a pathogen genotype ...</a>
        </div>
      </div>
    </div>
    </div>
% }
    <div class="col-sm-7 col-md-7">
    <div class="curs-box">
      <div class="curs-box-title">
        <div>
Pathogen genotypes used in this session
        </div>
      </div>
      <div class="curs-box-body ng-cloak">
        <div ng-show="data.waitingForServer">
          <img ng-src="{{app_static_path + '/images/spinner.gif'}}"></img>
        </div>

        <div ng-hide="data.waitingForServer">
        <div ng-show="data.genotypes.length != 0">
          <div class="curs-genotype-list-instructions">
Click a description to view <% !$read_only_curs ? 'and edit' : '' %> genotype details
          </div>

          <genotype-list-view genotype-list="data.genotypes"></genotype-list-view>
        </div>
        <div ng-show="data.genotypes.length == 0">
No pathogen genotypes in this session.  Try adding one.

        </div>
        </div>
      </div>
    </div>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-5 col-md-5">
 <button type="button" id="curs-finish-genotype" class="btn btn-primary curs-back-button"><% $finish_text %></button>
    </div>
  </div>
  </div>
  <div ng-show="data.genotypeSearching" class="curs-box ng-cloak">
    <div class="curs-box-title">
Pathogen genotype search
    </div>
    <div class="curs-box-body">
      <genotype-search></genotype-search>

      <button type="button" ng-click="cancelSearch()"
              class="btn btn-primary curs-back-button">&lt;- Back</button>
    </div>
  </div>
</div>


<%init>
my $start_path = $c->stash()->{curs_root_uri};

my $finish_text = '<- Back to summary';
</%init>
</div>
